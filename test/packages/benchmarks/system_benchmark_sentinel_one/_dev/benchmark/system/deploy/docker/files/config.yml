rules:
  - path: /web/api/v2.1/activities
    methods: ["GET"]
    responses:
      - status_code: 200
        body: |-
          {
            "data": [
              {{/* Comma is added at the end of each line inside the template to preserve JSON format */}}
              {{- $g := glob "/var/log/corpus-*" -}}
              {{- range $g -}}
                {{- file . -}}
              {{- end -}}
              {{/* A last line of hard-coded data is required to properly close the JSON body */}}
              {"accountId":"1234567890123456789","accountName":"Default","activityType":1234,"agentId":null,"agentUpdatedVersion":null,"comments":"True","createdAt":"2022-04-18T05:14:08.925421Z","data":{"accountName":"Default","byUser":"API","fullScopeDetails":"Account Default","fullScopeDetailsPath":"test/default","groupName":null,"newValue":true,"role":"Level","scopeLevel":"Account","scopeName":"Default","siteName":null,"userScope":"account","username":"API"},"description":"API","groupId":null,"groupName":null,"hash":null,"id":"1234567890123456789","osFamily":null,"primaryDescription":"The management user API enabled Two factor authentication on the user API.","secondaryDescription":null,"siteId":null,"siteName":null,"threatId":null,"updatedAt":"2022-04-18T05:14:08.922553Z","userId":"1234567890123456789"}
            ],
            "pagination": {
              "nextCursor": null
            }
          }
  - path: /web/api/v2.1/agents
    methods: ["GET"]
    responses:
      - status_code: 200
        body: |
          {"data":[{"accountId":"12345123451234512345","accountName":"Account Name","activeDirectory":{"computerDistinguishedName":null,"computerMemberOf":[],"lastUserDistinguishedName":null,"lastUserMemberOf":[]},"activeThreats":7,"agentVersion":"12.x.x.x","allowRemoteShell":true,"appsVulnerabilityStatus":"not_applicable","cloudProviders":{},"computerName":"user-test","consoleMigrationStatus":"N/A","coreCount":2,"missingPermissions":["user-action-needed-bluetooth-per","user_action_needed_fda"],"cpuCount":2,"cpuId":"CPU Name","createdAt":"2022-03-18T09:12:00.519500Z","detectionState":null,"domain":"WORKGROUP","encryptedApplications":false,"externalId":"","externalIp":"81.2.69.143","firewallEnabled":true,"firstFullModeTime":null,"groupId":"1234567890123456789","groupIp":"81.2.69.144","groupName":"Default Group","id":"13491234512345","inRemoteShellSession":false,"infected":true,"installerType":".msi","isActive":true,"isDecommissioned":false,"isPendingUninstall":false,"isUninstalled":false,"isUpToDate":true,"lastActiveDate":"2022-03-17T09:51:28.506000Z","lastIpToMgmt":"81.2.69.145","lastLoggedInUserName":"","licenseKey":"","locationEnabled":true,"locationType":"not_applicable","locations":null,"machineType":"server","mitigationMode":"detect","mitigationModeSuspicious":"detect","modelName":"Compute Engine","networkInterfaces":[{"gatewayIp":"81.2.69.145","gatewayMacAddress":"00-00-5E-00-53-00","id":"1234567890123456789","inet":["81.2.69.144"],"inet6":["2a02:cf40:add:4002:91f2:a9b2:e09a:6fc6"],"name":"Ethernet","physical":"00-00-5E-00-53-00"}],"networkQuarantineEnabled":false,"networkStatus":"connected","operationalState":"na","operationalStateExpiration":null,"osArch":"64 bit","osName":"Linux Server","osRevision":"1234","osStartTime":"2022-04-06T08:27:14Z","osType":"linux","osUsername":null,"rangerStatus":"Enabled","rangerVersion":"21.x.x.x","registeredAt":"2022-04-06T08:26:45.515278Z","remoteProfilingState":"disabled","remoteProfilingStateExpiration":null,"scanAbortedAt":null,"scanFinishedAt":"2022-04-06T09:18:21.090855Z","scanStartedAt":"2022-04-06T08:26:52.838047Z","scanStatus":"finished","siteId":"1234567890123456789","siteName":"Default site","storageName":null,"storageType":null,"tags":{"sentinelone":[{"assignedBy":"test-user","assignedAt":"2018-02-27T04:49:26.257525Z","key":"key123","assignedById":"123456789012345678","id":"123456789012345678","value":"value123"}]},"threatRebootRequired":false,"totalMemory":1234,"updatedAt":"2022-04-07T08:31:47.481227Z","userActionsNeeded":["reboot_needed"],"uuid":"XXX35XXX8Xfb4aX0X1X8X12X343X8X30"}],"pagination":{"nextCursor":null,"totalItems":1}}
  - path: /web/api/v2.1/cloud-detection/alerts
    methods: ["GET"]
    responses:
      - status_code: 200
        body: |
          {
            "data": [
              {{/* Comma is added at the end of each line inside the template to preserve JSON format */}}
              {{- $g := glob "/var/log/corpus-*" -}}
              {{- range $g -}}
                {{- file . -}}
              {{- end -}}
              {{/* A last line of hard-coded data is required to properly close the JSON body */}}
              {"targetProcessInfo":{"tgtFileCreatedAt":"2018-02-27T04:49:26.257525Z","tgtFileIsSigned":"string","tgtFileOldPath":"string","tgtProcImagePath":"string","tgtProcSignedStatus":"string","tgtFileHashSha256":"2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824","tgtProcStorylineId":"string","tgtProcPid":"12345","tgtProcCmdLine":"string","tgtProcName":"string","tgtFileModifiedAt":"2018-02-27T04:49:26.257525Z","tgtFileId":"string","tgtProcIntegrityLevel":"unknown","tgtFileHashSha1":"aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d","tgtProcUid":"string","tgtProcessStartTime":"2018-02-27T04:49:26.257525Z","tgtFilePath":"string"},"alertInfo":{"createdAt":"2018-02-27T04:49:26.257525Z","srcIp":"81.2.69.142","incidentStatus":"string","registryOldValue":"string","alertId":"123456789123456789","dstPort":"1234","indicatorName":"string","registryPath":"string","loginType":"string","dstIp":"81.2.69.144","updatedAt":"2018-02-27T04:49:26.257525Z","indicatorDescription":"string","loginsUserName":"string","loginIsSuccessful":"string","indicatorCategory":"string","modulePath":"string","loginAccountSid":"string","dnsResponse":"string","netEventDirection":"string","registryValue":"string","srcMachineIp":"81.2.69.142","registryOldValueType":"string","eventType":"info","analystVerdict":"string","dvEventId":"string","dnsRequest":"string","loginIsAdministratorEquivalent":"string","loginAccountDomain":"string","tiIndicatorType":"string","moduleSha1":"aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d","source":"string","srcPort":"1234","tiIndicatorValue":"string","tiIndicatorSource":"string","reportedAt":"2018-02-27T04:49:26.257525Z","registryKeyPath":"string","tiIndicatorComparisonMethod":"string","hitType":"Events"},"sourceProcessInfo":{"integrityLevel":"unknown","pid":"12345","fileHashMd5":"5d41402abc4b2a76b9719d911017c592","filePath":"string","fileSignerIdentity":"string","pidStarttime":"2018-02-27T04:49:26.257525Z","storyline":"string","fileHashSha1":"aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d","uniqueId":"string","user":"string","commandline":"string","name":"string","fileHashSha256":"2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824","subsystem":"unknown"},"ruleInfo":{"severity":"Low","treatAsThreat":"UNDEFINED","id":"string","scopeLevel":"string","name":"string","description":"string"},"sourceParentProcessInfo":{"integrityLevel":"unknown","pid":"12345","fileHashMd5":"5d41402abc4b2a76b9719d911017c592","filePath":"string","fileSignerIdentity":"string","pidStarttime":"2018-02-27T04:49:26.257525Z","storyline":"string","fileHashSha1":"aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d","uniqueId":"string","user":"string","commandline":"string","name":"string","fileHashSha256":"2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824","subsystem":"unknown"},"agentDetectionInfo":{"osFamily":"string","uuid":"string","osName":"string","version":"3.x.x.x","siteId":"123456789123456789","name":"string","machineType":"string","osRevision":"string"},"kubernetesInfo":{"controllerName":"string","node":"string","namespace":"string","namespaceLabels":"string","pod":"string","controllerLabels":"string","controllerKind":"string","cluster":"string","podLabels":"string"},"containerInfo":{"id":"string","name":"string","image":"string","labels":"string"}}
            ],
            "pagination": {
              "nextCursor": null
            }
          }
  - path: /web/api/v2.1/groups
    methods: ["GET"]
    responses:
      - status_code: 200
        body: |
          {"data":[{"createdAt":"2022-04-05T16:01:56.928383Z","creator":"Test User","creatorId":"1234567890123456789","filterId":null,"filterName":null,"id":"1234567890123456789","inherits":true,"isDefault":true,"name":"Default Group","rank":null,"registrationToken":"eyxxxxxxxxxxxxxxxxxxxxkixZxx1xxxxx8xxx2xODA0ZxxxxTIwNjhxxxxxxxxxxxxxxiMWYxx1Ixxnxxxx0=","siteId":"1234567890123456789","totalAgents":1,"type":"static","updatedAt":"2022-04-05T16:01:57.564266Z"}],"pagination":{"nextCursor":null,"totalItems":1}}
  - path: /web/api/v2.1/threats
    methods: ["GET"]
    responses:
      - status_code: 200
        body: |-
          {"data":[{"agentDetectionInfo":{"accountId":"1234567890123456789","accountName":"Default","agentDetectionState":null,"agentDomain":"WORKGROUP","agentIpV4":"10.0.0.1","agentIpV6":"2a02:cf40::","agentLastLoggedInUpn":null,"agentLastLoggedInUserMail":null,"agentLastLoggedInUserName":"","agentMitigationMode":"protect","agentOsName":"linux","agentOsRevision":"1234","agentRegisteredAt":"2022-04-06T08:26:45.515278Z","agentUuid":"fwfbxxxxxxxxxxqcfjfnxxxxxxxxx","agentVersion":"21.x.x","cloudProviders":{},"externalIp":"81.2.69.143","groupId":"1234567890123456789","groupName":"Default Group","siteId":"1234567890123456789","siteName":"Default site"},"agentRealtimeInfo":{"accountId":"1234567890123456789","accountName":"Default","activeThreats":7,"agentComputerName":"test-LINUX","agentDecommissionedAt":null,"agentDomain":"WORKGROUP","agentId":"1234567890123456789","agentInfected":true,"agentIsActive":true,"agentIsDecommissioned":false,"agentMachineType":"server","agentMitigationMode":"detect","agentNetworkStatus":"connected","agentOsName":"linux","agentOsRevision":"1234","agentOsType":"linux","agentUuid":"fwfbxxxxxxxxxxqcfjfnxxxxxxxxx","agentVersion":"21.x.x.1234","groupId":"1234567890123456789","groupName":"Default Group","networkInterfaces":[{"id":"1234567890123456789","inet":["10.0.0.1"],"inet6":["2a02:cf40:add:4002:91f2:a9b2:e09a:6fc6"],"name":"Ethernet","physical":"DE:AD:00:00:BE:EF"}],"operationalState":"na","rebootRequired":false,"scanAbortedAt":null,"scanFinishedAt":"2022-04-06T09:18:21.090855Z","scanStartedAt":"2022-04-06T08:26:52.838047Z","scanStatus":"finished","siteId":"1234567890123456789","siteName":"Default site","storageName":null,"storageType":null,"userActionsNeeded":[]},"containerInfo":{"id":null,"image":null,"labels":null,"name":null},"id":"1234567890123456789","indicators":[],"kubernetesInfo":{"cluster":null,"controllerKind":null,"controllerLabels":null,"controllerName":null,"namespace":null,"namespaceLabels":null,"node":null,"pod":null,"podLabels":null},"mitigationStatus":[{"action":"unquarantine","actionsCounters":{"failed":0,"notFound":0,"pendingReboot":0,"success":1,"total":1},"agentSupportsReport":true,"groupNotFound":false,"lastUpdate":"2022-04-06T08:54:17.198002Z","latestReport":"/threats/mitigation-report","mitigationEndedAt":"2022-04-06T08:54:17.101000Z","mitigationStartedAt":"2022-04-06T08:54:17.101000Z","status":"success"},{"action":"kill","actionsCounters":null,"agentSupportsReport":true,"groupNotFound":false,"lastUpdate":"2022-04-06T08:45:55.303355Z","latestReport":null,"mitigationEndedAt":"2022-04-06T08:45:55.297364Z","mitigationStartedAt":"2022-04-06T08:45:55.297363Z","status":"success"}],"threatInfo":{"analystVerdict":"undefined","analystVerdictDescription":"Undefined","automaticallyResolved":false,"browserType":null,"certificateId":"","classification":"Trojan","classificationSource":"Cloud","cloudFilesHashVerdict":"black","collectionId":"1234567890123456789","confidenceLevel":"malicious","createdAt":"2022-04-06T08:45:54.519988Z","detectionEngines":[{"key":"sentinelone_cloud","title":"SentinelOne Cloud"}],"detectionType":"static","engines":["SentinelOne Cloud"],"externalTicketExists":false,"externalTicketId":null,"failedActions":false,"fileExtension":"EXE","fileExtensionType":"Executable","filePath":"default.exe","fileSize":1234,"fileVerificationType":"NotSigned","identifiedAt":"2022-04-06T08:45:53.968000Z","incidentStatus":"unresolved","incidentStatusDescription":"Unresolved","initiatedBy":"agent_policy","initiatedByDescription":"Agent Policy","initiatingUserId":null,"initiatingUsername":null,"isFileless":false,"isValidCertificate":false,"maliciousProcessArguments":null,"md5":null,"mitigatedPreemptively":false,"mitigationStatus":"not_mitigated","mitigationStatusDescription":"Not mitigated","originatorProcess":"default.exe","pendingActions":false,"processUser":"test user","publisherName":"","reachedEventsLimit":false,"rebootRequired":false,"sha1":"aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d","sha256":null,"storyline":"D0XXXXXXXXXXAF4D","threatId":"1234567890123456789","threatName":"default.exe","updatedAt":"2022-04-06T08:54:17.194122Z"},"whiteningOptions":["hash"]},{"agentDetectionInfo":{"accountId":"1234567890123456789","accountName":"Default","agentDetectionState":null,"agentDomain":"WORKGROUP","agentIpV4":"10.0.0.1","agentIpV6":"2a02:cf40::","agentLastLoggedInUpn":null,"agentLastLoggedInUserMail":null,"agentLastLoggedInUserName":"","agentMitigationMode":"detect","agentOsName":"linux","agentOsRevision":"1234","agentRegisteredAt":"2022-04-06T08:26:45.515278Z","agentUuid":"fwfbxxxxxxxxxxqcfjfnxxxxxxxxx","agentVersion":"21.x.x","cloudProviders":{},"externalIp":"81.2.69.143","groupId":"1234567890123456789","groupName":"Default Group","siteId":"1234567890123456789","siteName":"Default site"},"agentRealtimeInfo":{"accountId":"1234567890123456789","accountName":"Default","activeThreats":7,"agentComputerName":"test-LINUX","agentDecommissionedAt":null,"agentDomain":"WORKGROUP","agentId":"1234567890123456789","agentInfected":true,"agentIsActive":true,"agentIsDecommissioned":false,"agentMachineType":"server","agentMitigationMode":"detect","agentNetworkStatus":"connected","agentOsName":"linux","agentOsRevision":"1234","agentOsType":"linux","agentUuid":"fwfbxxxxxxxxxxqcfjfnxxxxxxxxx","agentVersion":"21.x.x.1234","groupId":"1234567890123456789","groupName":"Default Group","networkInterfaces":[{"id":"1234567890123456789","inet":["10.0.0.1"],"inet6":["2a02:cf40:add:4002:91f2:a9b2:e09a:6fc6"],"name":"Ethernet","physical":"DE:AD:00:00:BE:EF"}],"operationalState":"na","rebootRequired":false,"scanAbortedAt":null,"scanFinishedAt":"2022-04-06T09:18:21.090855Z","scanStartedAt":"2022-04-06T08:26:52.838047Z","scanStatus":"finished","siteId":"1234567890123456789","siteName":"Default site","storageName":null,"storageType":null,"userActionsNeeded":[]},"containerInfo":{"id":null,"image":null,"labels":null,"name":null},"id":"1234567890123456789","indicators":[{"category":"General","description":"Detected by the Static Engine","ids":[43],"tactics":[]},{"category":"Exploitation","description":"Document behaves abnormally","ids":[62],"tactics":[{"name":"Execution","source":"DEFAULT","techniques":[{"link":"https://example.com/","name":"T1234"},{"link":"https://example.com/","name":"T1234"},{"link":"https://example.com/","name":"T1234"}]},{"name":"Initial Access","source":"DEFAULT","techniques":[{"link":"https://example.com/","name":"T1234"}]}]},{"category":"Evasion","description":"Indirect command was executed","ids":[427],"tactics":[{"name":"Defense Evasion","source":"DEFAULT","techniques":[{"link":"https://example.com/","name":"T1234"},{"link":"https://example.com/","name":"T1234"}]}]},{"category":"Evasion","description":"Office program ran macro","ids":[434],"tactics":[{"name":"Execution","source":"DEFAULT","techniques":[{"link":"https://example.com","name":"T1234"}]},{"name":"Initial Access","source":"DEFAULT","techniques":[{"link":"https://example.com","name":"T1234"}]},{"name":"Execution","source":"DEFAULT","techniques":[{"link":"https://example.com","name":"T1234"}]}]},{"category":"Evasion","description":"Process wrote to a hidden file section","ids":[169],"tactics":[{"name":"Defense Evasion","source":"DEFAULT","techniques":[{"link":"https://example.com","name":"T1234"}]}]},{"category":"Evasion","description":"Suspicious registry key was created","ids":[171],"tactics":[{"name":"Defense Evasion","source":"DEFAULT","techniques":[{"link":"https://example.com","name":"T1234"}]}]}],"kubernetesInfo":{"cluster":null,"controllerKind":null,"controllerLabels":null,"controllerName":null,"namespace":null,"namespaceLabels":null,"node":null,"pod":null,"podLabels":null},"mitigationStatus":[],"threatInfo":{"analystVerdict":"undefined","analystVerdictDescription":"Undefined","automaticallyResolved":false,"browserType":null,"certificateId":"","classification":"Malware","classificationSource":"Static","cloudFilesHashVerdict":"black","collectionId":"1234567890123456789","confidenceLevel":"malicious","createdAt":"2022-04-06T08:57:34.744922Z","detectionEngines":[{"key":"pre_execution","title":"On-Write Static AI"},{"key":"data_files","title":"Documents, Scripts"}],"detectionType":"dynamic","engines":["Documents, Scripts","On-Write ABC"],"externalTicketExists":false,"externalTicketId":null,"failedActions":false,"fileExtension":"TXT","fileExtensionType":"Document","filePath":"test/path/user","fileSize":238592,"fileVerificationType":"NotSigned","identifiedAt":"2022-04-06T08:57:34.444000Z","incidentStatus":"unresolved","incidentStatusDescription":"Unresolved","initiatedBy":"agent_policy","initiatedByDescription":"Agent Policy","initiatingUserId":null,"initiatingUsername":null,"isFileless":false,"isValidCertificate":false,"maliciousProcessArguments":"test/path/user","md5":null,"mitigatedPreemptively":false,"mitigationStatus":"not_mitigated","mitigationStatusDescription":"Not mitigated","originatorProcess":"default.EXE","pendingActions":false,"processUser":"test_user","publisherName":"","reachedEventsLimit":false,"rebootRequired":false,"sha1":"aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d","sha256":null,"storyline":"7XXXXXXXXXDD5A41","threatId":"123456789","threatName":"Threats","updatedAt":"2022-04-06T08:57:37.672873Z"},"whiteningOptions":["hash","path","file_type"]}],"pagination":{"nextCursor":null,"totalItems":2}}
  - path: /web/api/v2.1/application-management/inventory
    methods: ['GET']
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
            "data": [
              {
                "applicationName": "7-Zip",
                "applicationVendor": "Igor Pavlov",
                "applicationVersionsCount": 1,
                "endpointsCount": 1,
                "estimate": false
              }
            ],
            "pagination": {
              "nextCursor": null
            }
          }
  - path: /web/api/v2.1/application-management/inventory/endpoints
    methods: ['GET']
    responses:
      - status_code: 200
        headers:
          Content-Type:
            - 'application/json'
        body: |-
          {
            "data": [
              {{/* Comma is added at the end of each line inside the template to preserve JSON format */}}
              {{- $g := glob "/var/log/corpus-*" -}}
              {{- range $g -}}
                {{- file . -}}
              {{- end -}}
              {{/* A last line of hard-coded data is required to properly close the JSON body */}}
              {"accountName":"Git","applicationInstallationDate":"2025-08-13T10:45:01Z","applicationInstallationPath":null,"applicationName":"The Git Development Community","coreCount":2,"cpe":"cpe:2.3:a:elastic:git:8.17.3:*:*:*:*:*:*:*","cpuCount":1,"detectionDate":"2025-05-29T18:00:51.166610Z","endpointId":"2169705024028266268","endpointName":"srv-win-defend-05","endpointType":"server","endpointUuid":"eb65e894dae97711ebb9a9091ae","fileSize":517364,"groupName":"Default Group","id":"22183577485514","osArch":"64 bit","osName":"Windows Server 2022 Datacenter","osType":"windows","osVersion":"Windows Server 2022 Datacenter 20348","siteName":"Default site","version":"8.17.3"}
            ],
            "pagination": {
              "nextCursor": null
            }
          }
