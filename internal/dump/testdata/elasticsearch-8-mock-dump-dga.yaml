---
version: 2
interactions:
    - id: 0
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: ""
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Authorization:
                - Basic ZWxhc3RpYzpjaGFuZ2VtZQ==
            User-Agent:
                - go-elasticsearch/7.17.10 (linux amd64; Go 1.21.3)
            X-Elastic-Client-Meta:
                - es=7.17.10,go=1.21.3,t=7.17.10,hc=1.21.3
        url: https://127.0.0.1:9200/
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 538
        uncompressed: false
        body: |
            {
              "name" : "ef4c4bab9373",
              "cluster_name" : "elasticsearch",
              "cluster_uuid" : "coeNP0PdQY-fabxLWSssFg",
              "version" : {
                "number" : "8.9.0",
                "build_flavor" : "default",
                "build_type" : "docker",
                "build_hash" : "8aa461beb06aa0417a231c345a1b8c38fb498a0d",
                "build_date" : "2023-07-19T14:43:58.555259655Z",
                "build_snapshot" : false,
                "lucene_version" : "9.7.0",
                "minimum_wire_compatibility_version" : "7.17.0",
                "minimum_index_compatibility_version" : "7.0.0"
              },
              "tagline" : "You Know, for Search"
            }
        headers:
            Content-Length:
                - "538"
            Content-Type:
                - application/json
            X-Elastic-Product:
                - Elasticsearch
        status: 200 OK
        code: 200
        duration: 4.329333ms
    - id: 1
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: ""
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Authorization:
                - Basic ZWxhc3RpYzpjaGFuZ2VtZQ==
            User-Agent:
                - go-elasticsearch/7.17.10 (linux amd64; Go 1.21.3)
            X-Elastic-Client-Meta:
                - es=7.17.10,go=1.21.3,t=7.17.10,hc=1.21.3
        url: https://127.0.0.1:9200/_index_template/*-dga.*
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 22
        uncompressed: false
        body: '{"index_templates":[]}'
        headers:
            Content-Length:
                - "22"
            Content-Type:
                - application/json
            X-Elastic-Product:
                - Elasticsearch
        status: 404 Not Found
        code: 404
        duration: 507.076µs
    - id: 2
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: ""
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Authorization:
                - Basic ZWxhc3RpYzpjaGFuZ2VtZQ==
            User-Agent:
                - go-elasticsearch/7.17.10 (linux amd64; Go 1.21.3)
            X-Elastic-Client-Meta:
                - es=7.17.10,go=1.21.3,t=7.17.10,hc=1.21.3
        url: https://127.0.0.1:9200/_index_template/*-dga.*
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 22
        uncompressed: false
        body: '{"index_templates":[]}'
        headers:
            Content-Length:
                - "22"
            Content-Type:
                - application/json
            X-Elastic-Product:
                - Elasticsearch
        status: 404 Not Found
        code: 404
        duration: 279.28µs
    - id: 3
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: ""
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Authorization:
                - Basic ZWxhc3RpYzpjaGFuZ2VtZQ==
            User-Agent:
                - go-elasticsearch/7.17.10 (linux amd64; Go 1.21.3)
            X-Elastic-Client-Meta:
                - es=7.17.10,go=1.21.3,t=7.17.10,hc=1.21.3
        url: https://127.0.0.1:9200/_index_template/*-dga.*
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 22
        uncompressed: false
        body: '{"index_templates":[]}'
        headers:
            Content-Length:
                - "22"
            Content-Type:
                - application/json
            X-Elastic-Product:
                - Elasticsearch
        status: 404 Not Found
        code: 404
        duration: 240.007µs
    - id: 4
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: ""
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Authorization:
                - Basic ZWxhc3RpYzpjaGFuZ2VtZQ==
            User-Agent:
                - go-elasticsearch/7.17.10 (linux amd64; Go 1.21.3)
            X-Elastic-Client-Meta:
                - es=7.17.10,go=1.21.3,t=7.17.10,hc=1.21.3
        url: https://127.0.0.1:9200/_ml/trained_models/dga_*?decompress_definition=false&include=definition%2Cfeature_importance_baseline%2Chyperparameters%2Ctotal_feature_importance
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 2880
        uncompressed: false
        body: |
            {"count":1,"trained_model_configs":[{"model_id":"dga_1611725_2.0","model_type":"tree_ensemble","created_by":"api_user","version":"8.9.0","create_time":1701103516636,"model_size_bytes":246784104,"estimated_operations":0,"license_level":"platinum","description":"Model used to detect domain generation algorithm (DGA) activity in your network data.","compressed_definition":"//REDACTED//","tags":["packetbeat-7.10.0-2021-03-10_expanded_8_analysis"],"metadata":{"analytics_config":{"max_num_threads":8,"create_time":1615403883977,"model_memory_limit":"6gb","allow_lazy_start":false,"description":"","analyzed_fields":{"excludes":[],"includes":["f.*","dns.response_code","malicious"]},"id":"packetbeat-7.10.0-2021-03-10_expanded_8_analysis","source":{"query":{"match_all":{}},"index":["packetbeat-7.10.0-2021-03-10_expanded"]},"analysis":{"classification":{"randomize_seed":1,"dependent_variable":"malicious","num_top_classes":2,"training_percent":100,"class_assignment_objective":"maximize_minimum_recall","prediction_field_name":"malicious_prediction"}},"dest":{"index":"packetbeat-7.10.0-2021-03-10_expanded_8_analysis","results_field":"ml"},"version":"7.11.0"}},"input":{"field_names":["dns.response_code","f.b0","f.b1","f.b10","f.b11","f.b12","f.b13","f.b14","f.b15","f.b16","f.b17","f.b18","f.b19","f.b2","f.b20","f.b21","f.b22","f.b23","f.b24","f.b25","f.b26","f.b27","f.b28","f.b29","f.b3","f.b30","f.b31","f.b32","f.b33","f.b34","f.b35","f.b36","f.b37","f.b38","f.b39","f.b4","f.b40","f.b41","f.b42","f.b43","f.b44","f.b45","f.b46","f.b47","f.b48","f.b49","f.b5","f.b50","f.b51","f.b52","f.b53","f.b54","f.b55","f.b56","f.b57","f.b58","f.b59","f.b6","f.b60","f.b7","f.b8","f.b9","f.t0","f.t1","f.t10","f.t11","f.t12","f.t13","f.t14","f.t15","f.t16","f.t17","f.t18","f.t19","f.t2","f.t20","f.t21","f.t22","f.t23","f.t24","f.t25","f.t26","f.t27","f.t28","f.t29","f.t3","f.t30","f.t31","f.t32","f.t33","f.t34","f.t35","f.t36","f.t37","f.t38","f.t39","f.t4","f.t40","f.t41","f.t42","f.t43","f.t44","f.t45","f.t46","f.t47","f.t48","f.t49","f.t5","f.t50","f.t51","f.t52","f.t53","f.t54","f.t55","f.t56","f.t57","f.t58","f.t59","f.t6","f.t7","f.t8","f.t9","f.tld","f.u0","f.u1","f.u10","f.u11","f.u12","f.u13","f.u14","f.u15","f.u16","f.u17","f.u18","f.u19","f.u2","f.u20","f.u21","f.u22","f.u23","f.u24","f.u25","f.u26","f.u27","f.u28","f.u29","f.u3","f.u30","f.u31","f.u32","f.u33","f.u34","f.u35","f.u36","f.u37","f.u38","f.u39","f.u4","f.u40","f.u41","f.u42","f.u43","f.u44","f.u45","f.u46","f.u47","f.u48","f.u49","f.u5","f.u50","f.u51","f.u52","f.u53","f.u54","f.u55","f.u56","f.u57","f.u58","f.u59","f.u6","f.u60","f.u61","f.u7","f.u8","f.u9"]},"inference_config":{"classification":{"num_top_classes":2,"top_classes_results_field":"top_classes","results_field":"malicious_prediction","num_top_feature_importance_values":0,"prediction_field_type":"number"}},"location":{"index":{"name":".ml-inference-000005"}}}]}
        headers:
            Content-Length:
                - "2880"
            Content-Type:
                - application/json
            X-Elastic-Product:
                - Elasticsearch
        status: 200 OK
        code: 200
        duration: 145.381452ms
    - id: 5
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: ""
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Authorization:
                - Basic ZWxhc3RpYzpjaGFuZ2VtZQ==
            User-Agent:
                - go-elasticsearch/7.17.10 (linux amd64; Go 1.21.3)
            X-Elastic-Client-Meta:
                - es=7.17.10,go=1.21.3,t=7.17.10,hc=1.21.3
        url: https://127.0.0.1:9200/_index_template/*-dga.*
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 22
        uncompressed: false
        body: '{"index_templates":[]}'
        headers:
            Content-Length:
                - "22"
            Content-Type:
                - application/json
            X-Elastic-Product:
                - Elasticsearch
        status: 404 Not Found
        code: 404
        duration: 2.7802ms
    - id: 6
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: ""
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Authorization:
                - Basic ZWxhc3RpYzpjaGFuZ2VtZQ==
            User-Agent:
                - go-elasticsearch/7.17.10 (linux amd64; Go 1.21.3)
            X-Elastic-Client-Meta:
                - es=7.17.10,go=1.21.3,t=7.17.10,hc=1.21.3
        url: https://127.0.0.1:9200/_index_template/*-dga.*
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 22
        uncompressed: false
        body: '{"index_templates":[]}'
        headers:
            Content-Length:
                - "22"
            Content-Type:
                - application/json
            X-Elastic-Product:
                - Elasticsearch
        status: 404 Not Found
        code: 404
        duration: 418.494µs
    - id: 7
      request:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        content_length: 0
        transfer_encoding: []
        trailer: {}
        host: ""
        remote_addr: ""
        request_uri: ""
        body: ""
        form: {}
        headers:
            Authorization:
                - Basic ZWxhc3RpYzpjaGFuZ2VtZQ==
            User-Agent:
                - go-elasticsearch/7.17.10 (linux amd64; Go 1.21.3)
            X-Elastic-Client-Meta:
                - es=7.17.10,go=1.21.3,t=7.17.10,hc=1.21.3
        url: https://127.0.0.1:9200/_index_template/*-dga.*
        method: GET
      response:
        proto: HTTP/1.1
        proto_major: 1
        proto_minor: 1
        transfer_encoding: []
        trailer: {}
        content_length: 22
        uncompressed: false
        body: '{"index_templates":[]}'
        headers:
            Content-Length:
                - "22"
            Content-Type:
                - application/json
            X-Elastic-Product:
                - Elasticsearch
        status: 404 Not Found
        code: 404
        duration: 3.221054ms
