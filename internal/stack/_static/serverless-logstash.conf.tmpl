input {
  elastic_agent {
    port => 5044
    ssl_enabled => true
    ssl_certificate_authorities => ["/usr/share/logstash/config/certs/ca-cert.pem"]
    ssl_certificate => "/usr/share/logstash/config/certs/cert.pem"
    ssl_key => "/usr/share/logstash/config/certs/logstash.pkcs8.key"
  }
}


filter {
  elastic_integration {
    remove_field => ['@version']
    hosts => ["{{ fact "elasticsearch_host" }}"]
    username => '{{ fact "username" }}'
    password => '{{ fact "password" }}'
    ssl_enabled => true
    ssl_verification_mode => "full"
  }
}


output {
  elasticsearch {
    hosts => ["{{ fact "elasticsearch_host" }}"]
    user => '{{ fact "username" }}'
    password => '{{ fact "password" }}'
    ssl_enabled => true
    ssl_verification_mode => "none"
    data_stream => "true"
  }
}
